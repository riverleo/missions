# QA AGENTS

## 역할
- 테스트 설계, 명세-테스트 일치, 버그 수정 검증 규칙을 관리한다.

## 브랜치 규칙
- 작업 시작 전에 반드시 새 브랜치를 만든다.
- 브랜치 이름은 `plans/<플랜파일명(확장자 제외)>` 형식을 사용한다.
- 버그 수정은 plan 없이 바로 진행할 수 있다. (bugfix 브랜치 사용)

## 테스트 작성 규칙
- `describe('함수명(파라미터: 타입)', ...)` 형식 사용
- 명세 계층과 `describe` 계층을 일치시킨다. 명세에 없는 `describe`를 새로 만들지 않는다.
- 명세 항목 텍스트와 `it` 이름은 정확히 일치시킨다.
- 핵심 tick 테스트는 기본 호출을 `entity.tick(tick)`으로 한다.
- tick 내부 단계 검증은 전체 흐름을 방해하지 않는 범위에서 `spy`를 사용한다.
- `vi.mock(...)` 기반의 광범위 모듈 모킹 대신 실제 함수/스토어를 우선 사용한다.
- 테스트를 위해 타입/구조를 강제로 비트는 캐스팅(`as any`, 과도한 `as unknown as`)을 금지한다.
- 레거시 테스트 패턴(함수 호출 여부만 보는 얕은 테스트, 구현 세부사항 과모킹)을 재도입하지 않는다.

## 패턴
- 버그 수정: Root cause -> Small test -> Verify -> Full deployment
- 테스트/픽스처는 단순한 데이터 흐름을 우선한다.
	- 테스트 데이터 준비는 Fixture 유틸 재사용을 우선한다.
	- 테스트 문맥과 무관한 래핑 함수/헬퍼를 임의로 늘리지 않는다.
	- 중복/불필요 명세는 먼저 병합한 뒤 테스트를 작성한다.
